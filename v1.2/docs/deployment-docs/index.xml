<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>KubeClipper – 部署文档</title><link>https://www.kubeclipper.io//v1.2/docs/deployment-docs/</link><description>Recent content in 部署文档 on KubeClipper</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Tue, 16 Aug 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://www.kubeclipper.io//v1.2/docs/deployment-docs/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: 部署 HA</title><link>https://www.kubeclipper.io//v1.2/docs/deployment-docs/ha-env/</link><pubDate>Tue, 16 Aug 2022 00:00:00 +0000</pubDate><guid>https://www.kubeclipper.io//v1.2/docs/deployment-docs/ha-env/</guid><description>
&lt;p>本文档旨在通过简单的操作部署一个 HA 版本的 kubeclipper。&lt;/p>
&lt;blockquote>
&lt;p>如果只是想简单体验一下，请参考 &lt;a href="https://github.com/kubeclipper/kubeclipper/blob/master/README_zh.md#quick-start">QuickStart&lt;/a> 部署 AIO 环境。&lt;/p>
&lt;/blockquote>
&lt;h2 id="准备工作">准备工作&lt;/h2>
&lt;p>HA 部署注意事项：&lt;/p>
&lt;ul>
&lt;li>kubeclipper 使用 etcd 作为后端存储，为了保证高可用，建议使用 3 节点及以上来部署。&lt;/li>
&lt;li>生产环境建议 server 节点和 agent 节点分离，避免某一主机同时作为 server 节点和 agent 节点。&lt;/li>
&lt;/ul>
&lt;p>主机要求：您仅需参考 &lt;a href="https://github.com/kubeclipper/kubeclipper/blob/master/README_zh.md#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">准备工作&lt;/a> 中对机器硬件和操作系统的要求准备多台主机。&lt;/p>
&lt;h2 id="部署-kubeclipper">部署 KubeClipper&lt;/h2>
&lt;h3 id="下载-kcctl">下载 kcctl&lt;/h3>
&lt;p>KubeClipper 提供了命令行工具🔧 kcctl 以简化运维工作，您可以直接使用以下命令下载最新版 kcctl：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 默认安装最新发行版&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -sfL https://oss.kubeclipper.io/kcctl.sh &lt;span style="color:#000;font-weight:bold">|&lt;/span> bash -
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8f5902;font-style:italic"># 如果你在中国， 你可以在安装时使用 cn 环境变量, 此时我们会使用 registry.aliyuncs.com/google_containers 代替 k8s.gcr.io&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl -sfL https://oss.kubeclipper.io/kcctl.sh &lt;span style="color:#000;font-weight:bold">|&lt;/span> &lt;span style="color:#000">KC_REGION&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>cn bash -
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>您也可以在 &lt;a href="https://github.com/kubeclipper/kubeclipper/releases">GitHub Release Page&lt;/a> 下载指定版本。&lt;/p>
&lt;/blockquote>
&lt;p>通过以下命令检测是否安装成功:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kcctl version
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="开始安装">开始安装&lt;/h3>
&lt;p>您只需执行一个命令即可安装 KubeClipper，其模板如下所示：&lt;/p>
&lt;pre tabindex="0">&lt;code>kcctl deploy [--user root] (--passwd SSH_PASSWD | --pk-file SSH_PRIVATE_KEY) (--server SERVER_NODES) (--agent AGENT_NODES)
&lt;/code>&lt;/pre>&lt;p>若使用 ssh passwd 方式则命令如下所示:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kcctl deploy --user root --passwd &lt;span style="color:#000">$SSH_PASSWD&lt;/span> --server SERVER_NODES --agent AGENT_NODES
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>私钥方式如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kcctl deploy --user root --pk-file &lt;span style="color:#000">$SSH_PRIVATE_KEY&lt;/span> --server SERVER_NODES --agent AGENT_NODES
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>您只需要提供 ssh user 以及 ssh passwd 或者 ssh 私钥即可在对应节点部署 KubeClipper。&lt;/p>
&lt;/blockquote>
&lt;p>本教程使用 私钥 方式进行部署，具体命令如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kcctl deploy --server 192.168.10.110,192.168.10.111,192.168.10.112 --agent 192.168.10.113,192.168.10.114,192.168.10.115 --pk-file ~/.ssh/id_rsa --pkg https://oss.kubeclipper.io/release/v1.1.0/kc-amd64.tar.gz
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;blockquote>
&lt;p>该命令指定 kubeclipper 包含 3 server 节点，3 agent 节点。&lt;/p>
&lt;/blockquote>
&lt;p>您可以访问 &lt;a href="https://github.com/kubeclipper/kubeclipper/releases">GitHub Release Page&lt;/a> 查看当前 KubeClipper 的 Release 版本，来修改 pkg 参数中的版本号。&lt;/p>
&lt;blockquote>
&lt;p>比如在 v1.2.0 版本 release 之后您可以指定 &amp;ndash;pkg 为 &lt;code>https://oss.kubeclipper.io/release/v1.2.0/kc-amd64.tar.gz&lt;/code> 来安装 v1.2.0 版本。&lt;/p>
&lt;/blockquote>
&lt;p>执行该命令后，Kcctl 将检查您的安装环境，若满足条件将会进入安装流程。在打印出如下的 KubeClipper banner 后即表示安装完成。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-text" data-lang="text">&lt;span style="display:flex;">&lt;span> _ __ _ _____ _ _
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| | / / | | / __ \ (_)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| |/ / _ _| |__ ___| / \/ |_ _ __ _ __ ___ _ __
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| \| | | | &amp;#39;_ \ / _ \ | | | | &amp;#39;_ \| &amp;#39;_ \ / _ \ &amp;#39;__|
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>| |\ \ |_| | |_) | __/ \__/\ | | |_) | |_) | __/ |
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>\_| \_/\__,_|_.__/ \___|\____/_|_| .__/| .__/ \___|_|
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> | | | |
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> |_| |_|
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="登录控制台">登录控制台&lt;/h3>
&lt;p>安装完成后，打开浏览器，访问 &lt;code>http://$IP&lt;/code> 即可进入 KubeClipper 控制台。
&lt;img src="https://www.kubeclipper.io//v1.2/images/docs-quickstart/console-login.png" alt="console">&lt;/p>
&lt;p>您可以使用默认帐号密码 &lt;code>admin / Thinkbig1&lt;/code> 进行登录。&lt;/p>
&lt;blockquote>
&lt;p>您可能需要配置端口转发规则并在安全组中开放端口，以便外部用户访问控制台。&lt;/p>
&lt;/blockquote></description></item></channel></rss>